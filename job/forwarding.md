	If the intermediate routers in the backbone do not have any information about the routes to the VPNs, how are packets forwarded from one VPN site to another?  
	When a PE receives an IP packet from a CE device, it chooses a particular VRF in which to look up the packet’s destination address. This choice is based on the packet’s ingress attachment circuit.
	Assume that a match is found.  As a result we learn the packet’s "next hop".   
	If the packet’s next hop is reached directly over a VRF attachment circuit from this PE (i.e., the packet’s egress attachment circuit is on the same PE as its ingress attachment circuit), then the packet is sent on the egress attachment circuit, and no MPLS labels are pushed onto the packet’s label stack.   
	If the ingress and egress attachment circuits are on the same PE, but are associated with different VRFs, and if the route that best matches the destination address in the ingress attachment circuit’s VRF is an aggregate of several routes in the egress attachment   circuit’s VRF, it may be necessary to look up the packet’s destination address in the egress VRF as well.   
	If the packet’s next hop is NOT reached through a VRF attachment circuit, then the packet must travel at least one hop through the backbone.  The packet thus has a "BGP Next Hop", and the BGP Next Hop will have assigned an MPLS label for the route that best matches the packet’s destination address.  Call this label the "VPN route label". The IP packet is turned into an MPLS packet with the VPN route label as the sole label on the label stack. 
	The packet must then be tunneled to the BGP Next Hop.   
	If the backbone supports MPLS, this is done as follows:
		 - The PE routers (and any Autonomous System border routers) that redistribute VPN-IPv4 addresses need to insert /32 address prefixes for themselves into the IGP routing tables of the backbone.  This enables MPLS, at each node in the backbone network, to assign a label corresponding to the route to each PE router.  To ensure interoperability among different implementations, it is required to support LDP for setting up the label switched paths across the backbone.  However, other methods of setting up these label switched paths are also possible. (Some of these other methods may not require the presence of the /32 address prefixes in the IGP.)     
		- If there are any traffic engineering tunnels to the BGP next hop, and if one or more of those is available for use by the packet in question, one of these tunnels is chosen.  This tunnel will be associated with an MPLS label, the "tunnel label".  The tunnel label gets pushed on the MPLS label stack, and the packet is forwarded to the tunnel’s next hop.
		- Otherwise,         
			* The packet will have an "IGP Next Hop", which is the next hop along the IGP route to the BGP Next Hop.         
			* If the BGP Next Hop and the IGP Next Hop are the same, and if penultimate hop popping is used, the packet is then sent to the IGP Next Hop, carrying only the VPN route label. 
			* Otherwise, the IGP Next Hop will have assigned a label for the route that best matches the address of the BGP Next Hop. Call this the "tunnel label".  The tunnel label gets pushed on as the packet’s top label.  The packet is then forwarded to the IGP Next Hop.     
		- MPLS will then carry the packet across the backbone to the BGP Next Hop, where the VPN label will be examined.
	At the BGP Next Hop, the treatment of the packet depends on the VPN   route label (see Section 4.3.2).  In many cases, the PE will be able   to determine, from this label, the attachment circuit over which the   packet should be transmitted (to a CE device), as well as the proper   data link layer header for that interface.  In other cases, the PE   may only be able to determine that the packet’s destination address   needs to be looked up in a particular VRF before being forwarded to a   CE device.  There are also intermediate cases in which the VPN route   label may determine the packet’s egress attachment circuit, but a   lookup (e.g., ARP) still needs to be done in order to determine the   packet’s data link header on that attachment circuit.
	The fact that packets with VPN route labels are tunneled through the   backbone is what makes it possible to keep all the VPN routes out of   the P routers.  This is crucial to ensuring the scalability of the scheme.  The backbone does not even need to have routes to the CEs, only to the PEs.

	If MPLS is being used as the tunneling technology, this means that a router in the backbone MUST NOT accept a labeled packet from any adjacent non-backbone device unless the following two conditions   hold:      
		1. the label at the top of the label stack was actually distributed by that backbone router to that non-backbone device, and      
		2. the backbone router can determine that use of that label will cause the packet to leave the backbone before any labels lower in the stack will be inspected, and before the IP header will be inspected.
	

		The PE translates these addresses into VPN-IPv4 addresses, using a   configured RD.  The PE then treats these VPN-IPv4 routes as input to   BGP.  Routes from a VPN site are NOT leaked into the backbone’s IGP.

